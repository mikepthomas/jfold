<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ClientConnection.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jFold</a> &gt; <a href="index.source.html" class="el_package">info.mikethomas.jfold</a> &gt; <span class="el_source">ClientConnection.java</span></div><h1>ClientConnection.java</h1><pre class="source lang-java linenums">/*
 * #%L
 * This file is part of jFold.
 * %%
 * Copyright (C) 2012 - 2018 Mike Thomas &lt;mikepthomas@outlook.com&gt;
 * %%
 * jFold is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * %
 * jFold is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * %
 * You should have received a copy of the GNU General Public License
 * along with jFold.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 * #L%
 */
package info.mikethomas.jfold;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.module.jaxb.JaxbAnnotationModule;

import info.mikethomas.jfold.exceptions.InfoException;
import info.mikethomas.jfold.exceptions.NumSlotsException;
import info.mikethomas.jfold.exceptions.OptionsException;
import info.mikethomas.jfold.exceptions.PauseException;
import info.mikethomas.jfold.exceptions.PpdException;
import info.mikethomas.jfold.exceptions.QueueInfoException;
import info.mikethomas.jfold.exceptions.SimulationInfoException;
import info.mikethomas.jfold.exceptions.SlotAddException;
import info.mikethomas.jfold.exceptions.SlotInfoException;
import info.mikethomas.jfold.exceptions.SlotOptionsException;
import info.mikethomas.jfold.exceptions.UnpauseException;
import info.mikethomas.jfold.exceptions.UptimeException;
import info.mikethomas.jfold.info.InfoItem;
import info.mikethomas.jfold.options.Options;
import info.mikethomas.jfold.simulation.SimulationInfo;
import info.mikethomas.jfold.slot.Slot;
import info.mikethomas.jfold.slot.SlotOptions;
import info.mikethomas.jfold.unit.Unit;
import info.mikethomas.jfold.util.Command;

import java.io.IOException;
import java.net.Inet4Address;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

/**
 * &lt;p&gt;ClientConnection class.&lt;/p&gt;
 *
 * @author Michael Thomas (mikepthomas@outlook.com)
 * @version 7.4.4
 */
public class ClientConnection extends SocketConnection implements Connection {

    /** Constant &lt;code&gt;DEFAULT_HOST=&quot;localhost&quot;&lt;/code&gt;. */
    public static final String DEFAULT_HOST = &quot;localhost&quot;;
    /** Constant &lt;code&gt;DEFAULT_PORT=36330&lt;/code&gt;. */
    public static final int DEFAULT_PORT = 36330;

    /** Object Mapper. */
<span class="fc" id="L67">    private final ObjectMapper mapper = new ObjectMapper();</span>

    /**
     * &lt;p&gt;Default Constructor for ClientConnection.&lt;/p&gt;
     *
     * @throws java.io.IOException if any.
     */
    public ClientConnection() throws IOException {
<span class="nc" id="L75">        this(DEFAULT_HOST, DEFAULT_PORT);</span>
<span class="nc" id="L76">    }</span>

    /**
     * &lt;p&gt;Constructor for ClientConnection.&lt;/p&gt;
     *
     * @param address a {@link java.lang.String} object.
     * @param port a int.
     * @throws java.io.IOException a int.
     */
    public ClientConnection(final String address, final int port)
            throws IOException {
<span class="fc" id="L87">        super(address, port);</span>

<span class="fc" id="L89">        mapper.registerModule(new JaxbAnnotationModule());</span>
<span class="fc" id="L90">    }</span>

    /** {@inheritDoc} */
    @Override
    public final synchronized void bond(
            final Inet4Address ip, final int port, final String input) {
<span class="nc" id="L96">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void configured() {
<span class="nc" id="L102">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void doCycle() {
<span class="nc" id="L108">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void downloadCore(
            final String type, final URL url) {
<span class="nc" id="L115">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void finish() {
<span class="nc" id="L121">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void finish(final int slot) {
<span class="nc" id="L127">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized String getInfo(
            final String category, final String key) throws InfoException {
        try {
<span class="fc" id="L135">            List&lt;String&gt; args = new ArrayList&lt;String&gt;() { {</span>
<span class="fc" id="L136">                add(category);</span>
<span class="fc" id="L137">                add(key);</span>
<span class="fc" id="L138">            } };</span>
<span class="fc" id="L139">            return sendCommand(Command.GET_INFO, args);</span>
<span class="nc" id="L140">        } catch (IOException ex) {</span>
<span class="nc" id="L141">            throw new InfoException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized String getInfo(final InfoItem infoItem)
            throws InfoException {
<span class="fc" id="L149">        return getInfo(infoItem.getCategory().toString(), infoItem.toString());</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized List info() throws InfoException {
        try {
<span class="fc" id="L156">            return mapper.readValue(sendCommand(Command.INFO), List.class);</span>
<span class="nc" id="L157">        } catch (IOException ex) {</span>
<span class="nc" id="L158">            throw new InfoException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void inject(
            final Inet4Address ip, final int port, final String input) {
<span class="nc" id="L166">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void maskUnitState() {
<span class="nc" id="L172">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized int numSlots() throws NumSlotsException {
        try {
<span class="fc" id="L179">            return mapper.readValue(sendCommand(Command.NUM_SLOTS),</span>
                    Integer.class);
<span class="nc" id="L181">        } catch (IOException ex) {</span>
<span class="nc" id="L182">            throw new NumSlotsException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized String option(final String name) {
<span class="nc" id="L189">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized String option(
            final String name, final String value) {
<span class="nc" id="L196">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized Options options() throws OptionsException {
<span class="fc" id="L202">        return options(false, false);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized Options options(
            final boolean listDefault, final boolean listUnset)
            throws OptionsException {
        try {
<span class="fc" id="L211">            List&lt;String&gt; args = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L212" title="All 2 branches covered.">            if (listDefault) {</span>
<span class="fc" id="L213">                args.add(&quot;-d&quot;);</span>
            }
<span class="fc bfc" id="L215" title="All 2 branches covered.">            if (listUnset) {</span>
<span class="fc" id="L216">                args.add(&quot;-a&quot;);</span>
            }
<span class="fc" id="L218">            return mapper.readValue(sendCommand(Command.OPTIONS, args),</span>
                    Options.class);
<span class="nc" id="L220">        } catch (IOException ex) {</span>
<span class="nc" id="L221">            throw new OptionsException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void pause() throws PauseException {
        try {
<span class="nc" id="L229">            sendCommand(Command.PAUSE);</span>
<span class="nc" id="L230">        } catch (IOException ex) {</span>
<span class="nc" id="L231">            throw new PauseException(ex.getMessage(), ex);</span>
<span class="nc" id="L232">        }</span>
<span class="nc" id="L233">    }</span>

    /** {@inheritDoc} */
    @Override
    public final synchronized void pause(final int slot) throws PauseException {
        try {
<span class="fc" id="L239">            List&lt;String&gt; args = new ArrayList&lt;String&gt;() { {</span>
<span class="fc" id="L240">                add(String.valueOf(slot));</span>
<span class="fc" id="L241">            } };</span>
<span class="fc" id="L242">            sendCommand(Command.PAUSE, args);</span>
<span class="nc" id="L243">        } catch (IOException ex) {</span>
<span class="nc" id="L244">            throw new PauseException(ex.getMessage(), ex);</span>
<span class="fc" id="L245">        }</span>
<span class="fc" id="L246">    }</span>

    /** {@inheritDoc} */
    @Override
    public final synchronized int ppd() throws PpdException {
        try {
<span class="fc" id="L252">            return mapper.readValue(sendCommand(Command.PPD), Integer.class);</span>
<span class="nc" id="L253">        } catch (IOException ex) {</span>
<span class="nc" id="L254">            throw new PpdException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized List&lt;Unit&gt; queueInfo() throws QueueInfoException {
        try {
<span class="fc" id="L262">            TypeReference type = new TypeReference&lt;List&lt;Unit&gt;&gt;() { };</span>
<span class="fc" id="L263">            return mapper.readValue(sendCommand(Command.QUEUE_INFO), type);</span>
<span class="nc" id="L264">        } catch (IOException ex) {</span>
<span class="nc" id="L265">            throw new QueueInfoException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void requestId() {
<span class="nc" id="L272">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void requestWs() {
<span class="nc" id="L278">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void save() {
<span class="nc" id="L284">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void save(final String file) {
<span class="nc" id="L290">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void shutdown() {
<span class="nc" id="L296">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized SimulationInfo simulationInfo(
            final int slot) throws SimulationInfoException {
        try {
<span class="fc" id="L304">            List&lt;String&gt; args = new ArrayList&lt;String&gt;() { {</span>
<span class="fc" id="L305">                add(String.valueOf(slot));</span>
<span class="fc" id="L306">            } };</span>
<span class="fc" id="L307">            return mapper.readValue(sendCommand(Command.SIMULATION_INFO, args),</span>
                    SimulationInfo.class);
<span class="nc" id="L309">        } catch (IOException ex) {</span>
<span class="nc" id="L310">            throw new SimulationInfoException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void slotAdd(final String type)
            throws SlotAddException {
        try {
<span class="nc" id="L319">            List&lt;String&gt; args = new ArrayList&lt;String&gt;() { {</span>
<span class="nc" id="L320">                add(type);</span>
<span class="nc" id="L321">            } };</span>
<span class="nc" id="L322">            sendCommand(Command.SLOT_ADD, args);</span>
<span class="nc" id="L323">        } catch (IOException ex) {</span>
<span class="nc" id="L324">            throw new SlotAddException(ex.getMessage(), ex);</span>
<span class="nc" id="L325">        }</span>
<span class="nc" id="L326">    }</span>

    /** {@inheritDoc} */
    @Override
    public final synchronized void slotDelete(final int slot) {
<span class="nc" id="L331">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized List&lt;Slot&gt; slotInfo() throws SlotInfoException {
        try {
<span class="fc" id="L338">            TypeReference type = new TypeReference&lt;List&lt;Slot&gt;&gt;() { };</span>
<span class="fc" id="L339">            return mapper.readValue(sendCommand(Command.SLOT_INFO), type);</span>
<span class="nc" id="L340">        } catch (IOException ex) {</span>
<span class="nc" id="L341">            throw new SlotInfoException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void slotModify(
            final String id, final String type) {
<span class="nc" id="L349">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized SlotOptions slotOptions(final int slot)
            throws SlotOptionsException {
        try {
<span class="fc" id="L357">            List&lt;String&gt; args = new ArrayList&lt;String&gt;() { {</span>
<span class="fc" id="L358">                add(String.valueOf(slot));</span>
<span class="fc" id="L359">                add(&quot;-a&quot;);</span>
<span class="fc" id="L360">            } };</span>
<span class="fc" id="L361">            return mapper.readValue(sendCommand(Command.SLOT_OPTIONS, args),</span>
                    SlotOptions.class);
<span class="nc" id="L363">        } catch (IOException ex) {</span>
<span class="nc" id="L364">            throw new SlotOptionsException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void trajectory(final int slot) {
<span class="nc" id="L371">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void triggerSave() {
<span class="nc" id="L377">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void unpause() throws UnpauseException {
        try {
<span class="nc" id="L384">            sendCommand(Command.UNPAUSE);</span>
<span class="nc" id="L385">        } catch (IOException ex) {</span>
<span class="nc" id="L386">            throw new UnpauseException(ex.getMessage(), ex);</span>
<span class="nc" id="L387">        }</span>
<span class="nc" id="L388">    }</span>

    /** {@inheritDoc} */
    @Override
    public final synchronized void unpause(final int slot)
            throws UnpauseException {
        try {
<span class="fc" id="L395">            List&lt;String&gt; args = new ArrayList&lt;String&gt;() { {</span>
<span class="fc" id="L396">                add(String.valueOf(slot));</span>
<span class="fc" id="L397">            } };</span>
<span class="fc" id="L398">            sendCommand(Command.UNPAUSE, args);</span>
<span class="nc" id="L399">        } catch (IOException ex) {</span>
<span class="nc" id="L400">            throw new UnpauseException(ex.getMessage(), ex);</span>
<span class="fc" id="L401">        }</span>
<span class="fc" id="L402">    }</span>

    /** {@inheritDoc} */
    @Override
    public final synchronized String uptime() throws UptimeException {
        try {
<span class="fc" id="L408">            return sendCommand(Command.UPTIME);</span>
<span class="nc" id="L409">        } catch (IOException ex) {</span>
<span class="nc" id="L410">            throw new UptimeException(ex.getMessage(), ex);</span>
        }
    }

    /** {@inheritDoc} */
    @Override
    public final synchronized void waitForUnits() {
<span class="nc" id="L417">        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>